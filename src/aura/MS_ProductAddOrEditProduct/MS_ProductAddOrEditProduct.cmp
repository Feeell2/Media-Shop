<aura:component description="MS_ProductAddOrEditProduct"
                implements="flexipage:availableForAllPageTypes,force:lightningQuickActionWithoutHeader,flexipage:availableForRecordHome,force:hasRecordId,lightning:actionOverride"
                controller="MS_ProductAdding" access="global">
    <!--    <ltng:require styles="{!$Resource.NoHeader}"/>-->
    <lightning:quickActionAPI aura:id="quickActionAPI"/>
    <!--    <aura:attribute name="isModalOpen" type="boolean" default="false"/>-->
    <aura:attribute name="name" type="String"/>
    <aura:attribute name="brand" type="String"/>
    <aura:attribute name="model" type="String"/>
    <aura:attribute name="productCode" type="String"/>
    <aura:attribute name="installment" type="Boolean" default="false"/>
    <aura:attribute name="active" type="Boolean" default="false"/>
    <aura:attribute name="description" type="String"/>
    <aura:attribute name="cost" type="String" default="0"/>
    <aura:attribute name="currentInventory" type="String" default="0"/>
    <aura:attribute name="color" type="String"/>
    <aura:attribute name="idProduct" type="String"/>
    <aura:attribute name="idProfilePhoto" type="String" default=""/>
    <aura:attribute name="idPhotoToDelete" type="boolean" default="false"/>
    <aura:attribute name="isDeletePhotos" type="List" default="[]"/>

    <aura:attribute access="public" name="uploadedFiles" type="List" default="[]"/>
    <aura:attribute access="public" name="sObjectAttachedFiles" type="List" default="[]"/>
    <aura:attribute access="public" name="sObjectName" type="String" default=""/>
    <aura:attribute name="prefixURL" type="String" default="/servlet/servlet.FileDownload?file="/>

    <aura:attribute name="isAddPhoto" type="boolean" default="true"/>
    <aura:attribute name="isEditProduct" type="boolean" default="false"/>
    <aura:handler name="init" value="{!this}" action="{!c.init}"/>

    <aura:registerEvent name="appEvent" type="c:MS_ProductRefreshSlider"/>


    <lightning:overlayLibrary aura:id="overlayLib"/>
    <aura:if isTrue="{!v.isEditProduct}">
        <header class="slds-modal__header">
            <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Edit Product</h2>
        </header>
    </aura:if>

    <!-- Modal/Popup Box starts here-->
    <!--            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"-->
    <!--                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">-->
    <!--                <div class="slds-modal__container">-->
    <!-- Modal/Popup Box Header Starts here-->
    <aura:if isTrue="{!v.isAddPhoto}">

        <!--Modal/Popup Box Body Starts here-->
        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
            <div class="slds-grid slds-gutters">
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.name}" label="{!$Label.c.Name}" name="name"
                                     required="true"/>
                </div>
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.brand}" label="{!$Label.c.Brand}" name="brand"/>
                </div>
            </div>
            <div class="slds-grid slds-gutters">
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.model}" label="{!$Label.c.Model}" name="model"/>
                </div>
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.color}" label="{!$Label.c.Color}" name="color"/>
                </div>
            </div>
            <div class="slds-grid slds-gutters">
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.productCode}"
                                     label="{!$Label.c.Product_Code}"
                                     name="productCode"/>
                </div>
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.cost}" label="{!$Label.c.Cost}" name="cost"/>
                </div>
            </div>
            <div class="slds-grid slds-gutters">
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.currentInventory}"
                                     label="{!$Label.c.Current_Inventory}" name="currentInventory"/>
                </div>
                <div class=" slds-col productInput">

                    <lightning:input value="{!v.description}"
                                     label="{!$Label.c.Description}"
                                     name="description"/>
                </div>
            </div>
            <div class="slds-grid slds-gutters">
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.active}" name="active" label="{!$Label.c.Active}"
                                     type="checkbox"/>
                </div>
                <div class=" slds-col productInput">
                    <lightning:input value="{!v.installment}" name="installment" label="{!$Label.c.Installments}"
                                     type="checkbox"/>
                </div>
            </div>

        </div>

        <div class="slds-container_right" style="text-align:right">
            <lightning:button variant="neutral"
                              label="{!$Label.c.cancel}"
                              title="Cancel"
                              onclick="{! c.closeModel }"/>
            <lightning:button variant="brand"
                              label="{!$Label.c.Add}"
                              title="Add"
                              onclick="{!c.submitDetails}"/>
        </div>


        <aura:set attribute="else">
            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                <lightning:fileUpload label="{!$Label.c.Add_photos_and_select_the_main_photo}"
                                      name="fileUploader"
                                      multiple="true"
                                      accept="[ '.jpg', '.png']"
                                      recordId="{!v.idProduct}"
                                      onuploadfinished="{!c.handleUploadFinished}"/>
                <aura:if isTrue="{!v.isEditProduct}">
                <div class="slds-grid slds-m-around_medium">
                <lightning:input checked="{!v.idPhotoToDelete}" name="installment" label="Delete Mode"
                                 type="checkbox"/>
                <aura:if isTrue="{!v.idPhotoToDelete}">
                    <lightning:button label="Delete selected" onclick="{!c.deletePhotoSelected}"/>
                </aura:if>
                </div>
                </aura:if>

                <!--                <lightning:button label="Delete selected" onclick="{!c.handleCancelUpload}"/>-->
                <lightning:layout horizontalAlign="center" multipleRows="true">
                    <aura:iteration items="{!v.sObjectAttachedFiles}" var="file">
                        <lightning:layoutItem padding="around-small">
                            <div data-value="{!if(file.LatestPublishedVersionId!=null,file.LatestPublishedVersionId,file.Id)}"
                                 id="{!if(file.LatestPublishedVersionId!=null,file.LatestPublishedVersionId,file.Id)}"
                                 onclick="{!c.setMainPhoto}">
                                <lightning:button class="productImage"><img
                                        src="{!if(file.LatestPublishedVersionId!=null,'/sfc/servlet.shepherd/version/download/'+file.LatestPublishedVersionId,'/sfc/servlet.shepherd/version/download/'+file.Id)}"
                                        alt=""/>
                                </lightning:button>
                            </div>
                        </lightning:layoutItem>
                    </aura:iteration>
                </lightning:layout>
            </div>
            <div class="slds-container_right" style="text-align:right">
                <lightning:button variant="neutral"
                                  label="{!$Label.c.cancel}"
                                  title="Cancel"
                                  onclick="{!c.handleCancelUpload}"/>
                <lightning:button variant="brand"
                                  label="{!$Label.c.Add}"
                                  title="Add"
                                  onclick="{!c.submitPhotos}"/>
            </div>
        </aura:set>
    </aura:if>


    <!--            </section>-->
    <!--            <div class="slds-backdrop slds-backdrop_open"></div>-->


</aura:component>